var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,i=(a,t,n)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n;import{I as l,w as o,ap as s,e as r,aq as c,y as u,v as d}from"./index.c676d510.js";import{I as m}from"./index.8806b063.js";import{g as p,T as g,a as f,P as b}from"./usePagination.1c40eae7.js";import{u as h}from"./index.424a4305.js";import{j as v,k as y}from"./api.511880a4.js";import{g as S,q as O,e as w,a as j,H as x,d as C,r as P,o as z,c as D,B as k,N as I,D as N}from"./vendor.85ba868e.js";var R={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};function E(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var H=function(e,a){var t=function(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?Object(arguments[a]):{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(a){E(e,a,t[a])}))}return e}({},e,a.attrs);return S(l,O(t,{icon:R}),null)};H.displayName="DeleteOutlined",H.inheritAttrs=!1;const L=[{title:"No.",dataIndex:"id",slots:{customRender:"id"}},{title:"Email",dataIndex:"email"},{title:"Nickname",dataIndex:"name"},{title:"Create Time",dataIndex:"createTime",slots:{customRender:"createTime"}},{title:"Action",dataIndex:"action",slots:{customRender:"action"}}];var T=C({name:"Subscribe",components:{"a-input":m,"a-button":d,"a-table":g,"a-tag":f,"pop-confirm":b,SearchOutlined:h,DeleteOutlined:H},setup:()=>((e,l)=>{for(var o in l||(l={}))a.call(l,o)&&i(e,o,l[o]);if(t)for(var o of t(l))n.call(l,o)&&i(e,o,l[o]);return e})({},function(){const e=w(""),a=w(!1),t=p(),n=w([]),i=w([]),l=j((()=>0===i.value.length));function d(e){a.value=!0,i.value=[],v(e).then((e=>{a.value=!1,e.success?(n.value=s(e.data.list),t.total=e.data.total):o(e.message)})).catch((e=>{a.value=!1,r(e.message)}))}const m=a=>{y(a).then((a=>{a.success?(u(a.message),d({pageNo:t.current,pageSize:t.pageSize,email:e.value})):o(a.message)})).catch((e=>{r(e.message)}))};return x((()=>{d({pageNo:t.current,pageSize:t.pageSize})})),{email:e,deleteDisabled:l,loading:a,columns:L,pagination:t,selectedRowKeys:i,subscribeList:n,handleQueryList:function(){d({pageNo:t.current,pageSize:t.pageSize,email:e.value})},onSelectChange:function(e){i.value=e},handlePageChange:function(a){const n=a.current,i=a.pageSize;t.current=n,t.pageSize=i,d({pageNo:n,pageSize:i,email:e.value})},handleDeleteSubscribes:function(e){if(null===e)return void c("Confirm to delete these subscriptions").then((()=>{m({ids:[...i.value]})})).catch((()=>{}));const{id:a}=e;m({ids:[a]})}}}())});const _={class:"subscribe"},Q=S("h3",{class:"primary-title"},[S("i",{class:"iconfont icon-flashing"}),I(" Subscribe ")],-1),A={class:"filter-wrapper d-flex"},K={class:"filter-item d-flex"},q={class:"filter-item d-flex"},B=I(" Query "),M={class:"filter-item d-flex"},U=I(" Delete "),F=S("i",{class:"iconfont icon-delete"},null,-1);T.render=function(e,a,t,n,i,l){const o=P("a-input"),s=P("SearchOutlined"),r=P("a-button"),c=P("DeleteOutlined"),u=P("a-tag"),d=P("pop-confirm"),m=P("a-table");return z(),D("section",_,[Q,S("div",A,[S("div",K,[S(o,{placeholder:"Article title",value:e.email,"onUpdate:value":a[1]||(a[1]=a=>e.email=a),style:{width:"250px"},allowClear:"",onPressEnter:e.handleQueryList},null,8,["value","onPressEnter"])]),S("div",q,[S(r,{type:"primary",loading:e.loading,onClick:e.handleQueryList},{icon:k((()=>[S(s)])),default:k((()=>[B])),_:1},8,["loading","onClick"])]),S("div",M,[S(r,{loading:e.loading,disabled:e.deleteDisabled,onClick:a[2]||(a[2]=a=>e.handleDeleteSubscribes(null))},{icon:k((()=>[S(c)])),default:k((()=>[U])),_:1},8,["loading","disabled"])])]),S(m,{class:"subscribe-table",loading:e.loading,columns:e.columns,pagination:e.pagination,"row-key":e=>e.id,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},"data-source":e.subscribeList,onChange:e.handlePageChange},{id:k((({index:e})=>[I(N(e+1),1)])),createTime:k((({text:e})=>[S(u,{color:"cyan"},{default:k((()=>[I(N(e),1)])),_:2},1024)])),action:k((({record:a})=>[S(d,{title:"Sure to delete ?",onConfirm:t=>e.handleDeleteSubscribes(a)},{default:k((()=>[F])),_:2},1032,["onConfirm"])])),_:1},8,["loading","columns","pagination","row-key","row-selection","data-source","onChange"])])};export default T;
