var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,i=Object.prototype.propertyIsEnumerable,o=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,n=(e,n)=>{for(var s in n||(n={}))t.call(n,s)&&o(e,s,n[s]);if(a)for(var s of a(n))i.call(n,s)&&o(e,s,n[s]);return e};import{a7 as s,w as l,e as c,y as d,x as r,a8 as u,v as g,S as p}from"./index.886dfe0f.js";import{I as h}from"./index.ea47fda8.js";import{g as m,T as f,a as v,P as x}from"./usePagination.3f5c0e2c.js";import{u as b}from"./index.83b32b72.js";import{e as y,c as w,f as k}from"./api.b5828984.js";import{e as C,b as R,H as S,d as I,r as T,o as _,c as j,g as P,B as z,N as O,D as N}from"./vendor.85ba868e.js";const D=[{title:"No.",dataIndex:"id",slots:{customRender:"id"}},{title:"Article Title",dataIndex:"title"},{title:"Introduce",dataIndex:"introduce"},{title:"Tag",dataIndex:"tag",slots:{customRender:"tag"}},{title:"Cover",dataIndex:"cover",slots:{customRender:"cover"}},{title:"Views",dataIndex:"views"},{title:"Liked",dataIndex:"liked"},{title:"Show",dataIndex:"is_delete",slots:{customRender:"is_delete"},width:150},{title:"Create Time",dataIndex:"createTime",slots:{customRender:"createTime"}},{title:"Update Time",dataIndex:"updateTime",slots:{customRender:"updateTime"}},{title:"Action",dataIndex:"action",slots:{customRender:"action"}}];function E(){const e=u(),t=C(!1),a=C(""),i=m(),o=C([]),g=R({});function p(e){t.value=!0,y(e).then((e=>{e.success?(o.value=s(e.data.list),o.value.forEach((e=>{g[e.id]=n(n({},e),{show:0===e.is_delete})})),i.total=e.data.total):(o.value.length>0&&(o.value=[]),l(e.message)),t.value=!1})).catch((e=>{c(e.message),o.value.length>0&&(o.value=[]),t.value=!1}))}return S((()=>{p({pageNo:i.current,pageSize:i.pageSize})})),{articleTitle:a,loading:t,columns:D,articleList:o,pagination:i,editableData:g,handlePageChange:function(e){const t=e.current,o=e.pageSize;i.current=t,i.pageSize=o,p({pageNo:t,pageSize:o,title:a.value})},toEditRecord:function(t){const{id:a,uid:i}=t;e.push({path:"/edit",query:{id:a,uid:i}})},handleDeleteRecord:function(e){const{id:t,uid:a,cover:o}=e,n=r(o);k({id:t,uid:a,relativePath:n}).then((e=>{e.success?(d(e.message),p({pageNo:i.current,pageSize:i.pageSize})):l(e.message)})).catch((e=>{c(e.message)}))},switchChange:function(e,t){const{id:a,uid:i}=e,n=o.value.filter((e=>a===e.id))[0];w({id:a,uid:i,is_delete:t?0:1}).then((e=>{e.success?(d(e.message),g[a].show=t,Object.assign(n,g[a])):(l(e.message),g[a].show=!t)})).catch((e=>{c(e.message),g[a].show=!t}))},handleQueryRecords:function(){p({pageNo:i.current,pageSize:i.pageSize,title:a.value})}}}var L=I({name:"RecordList",components:{"a-input":h,"a-button":g,"a-table":f,"a-switch":p,"a-tag":v,"pop-confirm":x,SearchOutlined:b},setup:()=>n({},E())});const Q={class:"record-list scroller"},U=P("h3",{class:"primary-title"},[P("i",{class:"iconfont icon-flashing"}),O(" Record List ")],-1),A={class:"filter-wrapper d-flex"},H={class:"filter-item d-flex"},q={class:"filter-item d-flex"},B=O(" Query "),M=O("No Cover"),V={class:"action"},F=P("i",{class:"iconfont icon-delete"},null,-1);L.render=function(e,t,a,i,o,n){const s=T("a-input"),l=T("SearchOutlined"),c=T("a-button"),d=T("a-tag"),r=T("a-switch"),u=T("pop-confirm"),g=T("a-table");return _(),j("section",Q,[U,P("div",A,[P("div",H,[P(s,{placeholder:"Article title",value:e.articleTitle,"onUpdate:value":t[1]||(t[1]=t=>e.articleTitle=t),style:{width:"250px"},allowClear:"",onPressEnter:e.handleQueryRecords},null,8,["value","onPressEnter"])]),P("div",q,[P(c,{type:"primary",loading:e.loading,onClick:e.handleQueryRecords},{icon:z((()=>[P(l)])),default:z((()=>[B])),_:1},8,["loading","onClick"])])]),P(g,{class:"record-table",loading:e.loading,columns:e.columns,"row-key":e=>e.id,pagination:e.pagination,"data-source":e.articleList,onChange:e.handlePageChange},{id:z((({index:e})=>[O(N(e+1),1)])),tag:z((({text:e})=>["Mood"===e?(_(),j(d,{key:0,color:"#2db7f5"},{default:z((()=>[O(N(e),1)])),_:2},1024)):(_(),j(d,{key:1,color:"#87d068"},{default:z((()=>[O(N(e),1)])),_:2},1024))])),cover:z((({text:e})=>[e?(_(),j("img",{key:0,src:e,alt:"cover"},null,8,["src"])):(_(),j(d,{key:1,color:"red"},{default:z((()=>[M])),_:1}))])),createTime:z((({text:e})=>[P(d,{color:"cyan"},{default:z((()=>[O(N(e),1)])),_:2},1024)])),updateTime:z((({text:e})=>[P(d,{color:"green"},{default:z((()=>[O(N(e),1)])),_:2},1024)])),is_delete:z((({text:t,record:a})=>[P(r,{"checked-children":"S","un-checked-children":"H",checked:e.editableData[a.id].show,"onUpdate:checked":t=>e.editableData[a.id].show=t,onChange:t=>e.switchChange(a,t)},null,8,["checked","onUpdate:checked","onChange"])])),action:z((({record:t})=>[P("span",V,[P("i",{class:"iconfont icon-edit",onClick:a=>e.toEditRecord(t)},null,8,["onClick"]),P(u,{title:"Sure to delete ?",onConfirm:a=>e.handleDeleteRecord(t)},{default:z((()=>[F])),_:2},1032,["onConfirm"])])])),_:1},8,["loading","columns","row-key","pagination","data-source","onChange"])])};export default L;
