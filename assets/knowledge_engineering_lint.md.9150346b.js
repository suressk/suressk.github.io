import{_ as s,c as n,o as a,b as l}from"./app.ccfb43da.js";const A=JSON.parse('{"title":"ä»£ç è§„èŒƒ","description":"","frontmatter":{"title":"ä»£ç è§„èŒƒ"},"headers":[{"level":2,"title":"æœ€ç»ˆæ–¹æ¡ˆ","slug":"æœ€ç»ˆæ–¹æ¡ˆ","link":"#æœ€ç»ˆæ–¹æ¡ˆ","children":[]},{"level":2,"title":"ğŸ´â€â˜ ï¸ Eslint","slug":"ğŸ´â€â˜ ï¸-eslint","link":"#ğŸ´â€â˜ ï¸-eslint","children":[]},{"level":2,"title":"Git Flow","slug":"git-flow","link":"#git-flow","children":[]},{"level":2,"title":"Husky æ·»åŠ  git-hooks","slug":"husky-æ·»åŠ -git-hooks","link":"#husky-æ·»åŠ -git-hooks","children":[]},{"level":2,"title":"å®ç° Push & Release è„šæœ¬","slug":"å®ç°-push-release-è„šæœ¬","link":"#å®ç°-push-release-è„šæœ¬","children":[]}],"relativePath":"knowledge/engineering/lint.md"}'),o={name:"knowledge/engineering/lint.md"},p=l(`<div class="tip custom-block"><p class="custom-block-title">Lint</p><p>æ˜é‡‘ï¼š<a href="https://juejin.cn/post/7111759355766603784/" target="_blank" rel="noreferrer">å‰ç«¯å·¥ç¨‹åŒ–ä¹‹è§„èŒƒåŒ– ğŸ”—</a> â€”â€” 2022-06-22</p></div><h2 id="æœ€ç»ˆæ–¹æ¡ˆ" tabindex="-1">æœ€ç»ˆæ–¹æ¡ˆ <a class="header-anchor" href="#æœ€ç»ˆæ–¹æ¡ˆ" aria-hidden="true">#</a></h2><h2 id="ğŸ´â€â˜ ï¸-eslint" tabindex="-1">ğŸ´â€â˜ ï¸ Eslint <a class="header-anchor" href="#ğŸ´â€â˜ ï¸-eslint" aria-hidden="true">#</a></h2><p>ä½¿ç”¨ <code>eslint</code> è¿›è¡Œæ ¼å¼åŒ–ï¼Œä¸”ç¦ç”¨ <code>prettier</code> çš„æ ¼å¼åŒ–ï¼Œå¦åˆ™ä¸¤è€…ä¼šå­˜åœ¨å†²çª</p><ul><li>Install</li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">pnpm i eslint-config-suressk -D</span></span>
<span class="line"></span></code></pre></div><ul><li>Config <code>.eslintrc</code></li></ul><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">extends</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">suressk</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><ul><li><code>vscode config</code>ï¼Œåˆ›å»º <code>.vscode/settings.json</code> æ–‡ä»¶ï¼š</li></ul><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">/* ç¦ç”¨ prettier */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">prettier.enable</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">editor.codeActionsOnSave</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">source.fixAll.eslint</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="git-flow" tabindex="-1">Git Flow <a class="header-anchor" href="#git-flow" aria-hidden="true">#</a></h2><p>ä»£ç ç¼–å†™éœ€è¦è§„èŒƒï¼Œä»£ç åˆ†æ”¯ç®¡ç†åŒæ ·ä¹Ÿéœ€è¦æ‹¥æœ‰æµç¨‹å’Œè§„èŒƒ</p><blockquote><p><a href="https://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noreferrer">A successful Git branching model ğŸ”—ï¼š</a></p></blockquote><img src="https://nvie.com/img/git-model@2x.png" width="50%"><p>æ®ä¸Šå›¾æè¿°ï¼Œæˆ‘ä»¬ä¸€èˆ¬åˆ†ä¸º 5 æ¡å¸¸ç”¨åˆ†æ”¯æ–¹ä¾¿ç»Ÿä¸€ç®¡ç†ï¼š</p><ul><li><p><code>Production</code> åˆ†æ”¯</p><blockquote><p>ä¹Ÿå°±æ˜¯é»˜è®¤çš„ <code>master</code> åˆ†æ”¯ï¼ˆæˆ–é‡å‘½åçš„ä¸»åˆ†æ”¯åï¼Œå¦‚ <code>main</code>ï¼‰ï¼Œè¿™ä¸ªåˆ†æ”¯ç”¨äºå‘å¸ƒåˆ°æœ€æ–°çš„ç”Ÿäº§ç¯å¢ƒçš„ä»£ç ,<br> åŒ…å« <code>release</code> åˆ†æ”¯å‘å¸ƒçš„ç‰ˆæœ¬<br> è¿™ä¸ªåˆ†æ”¯çš„ä»£ç åªèƒ½ä»å…¶ä»–åˆ†æ”¯ <code>åˆå¹¶</code> è¿‡æ¥ï¼Œè€Œä¸åœ¨æ­¤åˆ†æ”¯ä¸Šç›´æ¥ä¿®æ”¹</p></blockquote></li><li><p><code>Release</code> åˆ†æ”¯</p><blockquote><p>å®ƒæ˜¯ç”¨äºæ¯æ¬¡å‘å¸ƒä»£ç çš„åˆ†æ”¯ï¼Œå‘ç‰ˆæ—¶å°±æŒ‰è§„èŒƒæ ‡å‡†åˆ›å»ºä¸€ä¸ª <code>release</code> åˆ†æ”¯ï¼Œå¹¶æ‰“ä¸Š <code>tag</code> å‘å¸ƒ<br> å†å°†å‘å¸ƒå®Œæˆçš„ä»£ç åˆå…¥ <code>ä¸»åˆ†æ”¯</code>ï¼Œå®ƒä¸€èˆ¬æ˜¯ç”± <code>Develop</code> åˆ†æ”¯æµ‹è¯•é€šè¿‡ä¹‹ååˆ›å»ºè€Œæ¥</p></blockquote></li><li><p><code>Develop</code> åˆ†æ”¯</p><blockquote><p>å®ƒæ˜¯æˆ‘ä»¬çš„ä¸»å¼€å‘åˆ†æ”¯ï¼ŒåŒ…å«æ‰€æœ‰è¦å‘å¸ƒåˆ°ä¸‹ä¸€ä¸ª <code>Release</code> çš„ä»£ç ï¼Œè¿™ä¸ªä¸»è¦åˆå¹¶äºå…¶ä»–åˆ†æ”¯ï¼Œæ¯”å¦‚ <code>Feature</code> åˆ†æ”¯</p></blockquote></li><li><p><code>Feature</code> åˆ†æ”¯</p><blockquote><p>å®ƒæ˜¯ç”¨æ¥å¼€å‘ä¸€ä¸ªæ–°çš„åŠŸèƒ½ï¼Œä¸€æ—¦å¼€å‘å®Œæˆï¼Œæˆ‘ä»¬åˆå¹¶å› <code>Develop</code> åˆ†æ”¯ï¼Œå¹¶è¿›å…¥ä¸‹ä¸€ä¸ª <code>Release</code></p></blockquote></li><li><p><code>Hotfix</code> åˆ†æ”¯</p><blockquote><p>å½“ç”Ÿäº§ç¯å¢ƒçš„ä»£ç å‡ºç° <code>bug</code> éœ€è¦ç´§æ€¥ä¿®å¤æ—¶ï¼Œæˆ‘ä»¬ä¼šä» <code>ä¸»åˆ†æ”¯</code> åˆ‡ä¸€ä¸ª <code>hotfix</code> åˆ†æ”¯å‡ºæ¥è¿›è¡Œä¿®å¤<br> æµ‹è¯•å®Œæ¯•ä¹‹ååˆå…¥ <code>ä¸»åˆ†æ”¯</code> å’Œ <code>Develop</code> åˆ†æ”¯ï¼Œå¹¶è¿›å…¥ä¸‹ä¸€ä¸ª <code>Release</code>ï¼ˆåˆå¹¶å®Œæ¯•åé€šå¸¸ä¼šåˆ æ‰æ­¤åˆ†æ”¯ï¼‰</p></blockquote></li></ul><p>ç»¼ä¸Šï¼Œç¤ºä¾‹åˆ†æ”¯åå¤§è‡´å¦‚ä¸‹ï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># master branch</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">main</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># release branch with version-number</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">release/v1.0.5</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># new features of Iteration-version-number</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">feat/v3.9</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#676E95;"># new feature of achieving reactivity</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">feat/reactivity</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># hotfix branch of issues-number</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">fix/issues-31</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#676E95;"># Often occurs when multiple people collaborate</span></span>
<span class="line"><span style="color:#676E95;"># hotfix branch of someone to fix the issue-number</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">fix/saul-issues-31</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#676E95;"># hotfix branch of bug-name and issue-number</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">fix/saul-type-call-31</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><h2 id="husky-æ·»åŠ -git-hooks" tabindex="-1">Husky æ·»åŠ  git-hooks <a class="header-anchor" href="#husky-æ·»åŠ -git-hooks" aria-hidden="true">#</a></h2><ul><li><p>å®‰è£…ç›¸å…³çš„ <code>package</code></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># husky æ·»åŠ  git-hooks</span></span>
<span class="line"><span style="color:#676E95;"># lint-stagedï¼š æ£€æµ‹ committed æ–‡ä»¶è¿›è¡Œæ ¼å¼åŒ–å¤„ç†ï¼ˆåº”ä¸ä¸Šé¢ eslint ç»“åˆçš„ï¼‰</span></span>
<span class="line"><span style="color:#676E95;"># conventional-changelog-cliï¼š ç”¨äºç”Ÿæˆ changelog.md æ–‡æ¡£</span></span>
<span class="line"><span style="color:#A6ACCD;">pnpm i husky lint-staged conventional-changelog-cli -D</span></span>
<span class="line"></span></code></pre></div></li><li><p>æ·»åŠ  <code>.husky</code> æ–‡ä»¶ï¼Œæ·»åŠ  <code>git-hooks</code></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># åˆ›å»º .husky ç›®å½•ï¼Œåˆå§‹åŒ– git-hooks</span></span>
<span class="line"><span style="color:#A6ACCD;">npx husky install</span></span>
<span class="line"><span style="color:#676E95;"># æ·»åŠ  pre-commit hook</span></span>
<span class="line"><span style="color:#A6ACCD;">npx husky-init</span></span>
<span class="line"></span></code></pre></div></li><li><p>ä¿®æ”¹ <code>.husky/pre-commit</code> æ–‡ä»¶</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">#!/usr/bin/env sh</span></span>
<span class="line"><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;$(</span><span style="color:#C3E88D;">dirname -- </span><span style="color:#89DDFF;">&quot;$</span><span style="color:#A6ACCD;">0</span><span style="color:#89DDFF;">&quot;)</span><span style="color:#C3E88D;">/_/husky.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># npm test  # è¿™å¥åˆ æ‰ï¼Œæ”¹ä¸ºä¸‹é¢è¿™è¡Œï¼Œè¿›è¡Œä»£ç æ ¼å¼åŒ–æ£€æµ‹</span></span>
<span class="line"><span style="color:#676E95;"># è¿™å¥éœ€è¦ç»“åˆ eslint æˆ– prettier æ¥è¿›è¡Œä»£ç æ ¼å¼åŒ–</span></span>
<span class="line"><span style="color:#A6ACCD;">npx lint-staged</span></span>
<span class="line"></span></code></pre></div></li><li><p>æ·»åŠ  <code>commit-msg</code> hookï¼Œå¹¶ä¿®æ”¹ <code>.husky/commit-msg</code> æ–‡ä»¶</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># æ·»åŠ  commit-msg hookï¼Œ&quot;$1&quot; å‚æ•°ä¸ä¼šè¢«æ­¤å‘½ä»¤å†™è¿› .husky/commit-msg æ–‡ä»¶</span></span>
<span class="line"><span style="color:#676E95;"># ä¸‹é¢éœ€è¦æ‰‹åŠ¨æ·»åŠ ï¼Œå¦åˆ™å°†æ‹¿ä¸åˆ° commit message ä¿¡æ¯</span></span>
<span class="line"><span style="color:#A6ACCD;">npx husky add .husky/commit-msg </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">npx ts-node scripts/verify-commit.ts &quot;$1&quot;</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">#!/usr/bin/env sh</span></span>
<span class="line"><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;$(</span><span style="color:#C3E88D;">dirname -- </span><span style="color:#89DDFF;">&quot;$</span><span style="color:#A6ACCD;">0</span><span style="color:#89DDFF;">&quot;)</span><span style="color:#C3E88D;">/_/husky.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">npx ts-node scripts/verify-commit.ts </span><span style="color:#89DDFF;">&quot;$</span><span style="color:#A6ACCD;">1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># æ·»åŠ  &quot;$1&quot; å‚æ•°</span></span>
<span class="line"></span></code></pre></div></li><li><p><code>package.json</code> é…ç½® <code>git-hooks</code>ï¼ˆå¥½åƒä¸é…ç½®ä¹Ÿæ²¡ä»€ä¹ˆå½±å“ï¼‰ï¼Œ<code>lint-staged</code> éœ€è¦é…ç½®</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// package.json</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">husky</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">hooks</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">pre-commit</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">lint-staged</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">commit-msg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ts-node scripts/verify-commit.ts</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">lint-staged</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">eslint . --fix</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></li></ul><h2 id="å®ç°-push-release-è„šæœ¬" tabindex="-1">å®ç° Push &amp; Release è„šæœ¬ <a class="header-anchor" href="#å®ç°-push-release-è„šæœ¬" aria-hidden="true">#</a></h2><ul><li><p>åˆ›å»º <code>scripts</code> ç›®å½•ï¼Œç”¨äºå®ç°æ‰§è¡Œ <code>shell</code> å‘½ä»¤çš„è„šæœ¬æ–‡ä»¶ï¼Œé€šè¿‡ <code>terminal äº¤äº’</code> å®Œæˆ <code>commit</code> ä¿¡æ¯æ ¼å¼éªŒè¯ï¼Œ<code>release</code> ç‰ˆæœ¬ç¡®è®¤ç­‰åŠŸèƒ½</p></li><li><p>å®‰è£…ç›¸å…³çš„ <code>package</code></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># ts-node: node ç¯å¢ƒç›´æ¥æ‰§è¡Œ ts æ–‡ä»¶</span></span>
<span class="line"><span style="color:#676E95;"># execa: ç”¨äºæ‰§è¡Œ è„šæœ¬ çš„åŒ…</span></span>
<span class="line"><span style="color:#676E95;"># prompts: ä»¥äº¤äº’å¼çš„æ–¹å¼ï¼Œè·å–å‘½ä»¤è¡Œäº¤äº’çš„å†…å®¹</span></span>
<span class="line"><span style="color:#676E95;"># picocolors: ç¾åŒ–å‘½ä»¤è¡Œ log å†…å®¹</span></span>
<span class="line"><span style="color:#A6ACCD;">pnpm i ts-node execa prompts picocolors -D</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># semver: ç”¨äºä¸“é—¨åˆ†æ Semantic Versionï¼ˆè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼‰çš„å·¥å…·ï¼ˆreleaseï¼‰</span></span>
<span class="line"><span style="color:#676E95;"># minimist: ç”¨äºè§£æè·å¾— process å‘½ä»¤è¡Œå‚æ•°</span></span>
<span class="line"><span style="color:#676E95;"># fs-extra: ç”¨äºè¯»å–æ–‡ä»¶ï¼Œå¯ç›´æ¥è¯»å–ä¸º json æ ¼å¼ï¼Œçœå» fs è¯»å–ä¹‹åè¿˜è¦è½¬åŒ–ä¸º json</span></span>
<span class="line"><span style="color:#A6ACCD;">pnpm i semver minimist fs-extra @types/minimist @types/fs-extra -D</span></span>
<span class="line"></span></code></pre></div></li><li><p>åˆ›å»º <code>scripts/tsconfig.json</code> æ–‡ä»¶ï¼Œç”¨äºåœ¨ <code>node</code> ç¯å¢ƒå®ç° <code>ts-node</code> å¯ä»¥ç¼–è¯‘æ‰§è¡Œ <code>ESM</code> æ ¼å¼çš„ <code>ts</code> è„šæœ¬ <a href="/knowledge/engineering/tsconfig.html">tsconfig é…ç½®è¯´æ˜ ğŸ”—</a></p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">include</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">compilerOptions</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">module</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">CommonJS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">target</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ES2020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">moduleResolution</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Node</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">strict</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">esModuleInterop</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">skipLibCheck</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">noUnusedLocals</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/* æœªç”¨åˆ°çš„å¼•ç”¨ */</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">forceConsistentCasingInFileNames</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></li><li><p>åœ¨ <code>package.json</code> ä¸­åˆ›å»ºè¦æ‰§è¡Œçš„è„šæœ¬å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// package.json</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">push</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ts-node scripts/push.ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">release</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ts-node scripts/release.ts</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;">/* ... other command */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></li><li><p>åœ¨ <code>scripts</code> ç›®å½•ä¸‹åˆ›å»ºæˆ‘ä»¬ ä¸Šé¢é…ç½®å‘½ä»¤ è¦æ‰§è¡Œçš„ <code>ts</code> æ–‡ä»¶</p><p><strong>â›© è¯¦ç»†ç¤ºä¾‹å¯è§ <a href="https://github.com/suressk/sure-utils/tree/main/scripts" target="_blank" rel="noreferrer">Githubï¼š */scripts/* ğŸ”—</a></strong></p><p>è¿™é‡Œå†™å‡ ä¸ªç¤ºä¾‹çš„ <code>utils</code> æ–¹æ³•ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> minimist </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">minimist</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> execa </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">execa</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> fsExtra </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fs-extra</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Options</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">as</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ExecaOptions</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">execa</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// get shell command arguments</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> args </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">minimist</span><span style="color:#A6ACCD;">(process</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">argv</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">slice</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// run shell command</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">run</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;">[]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">opts</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExecaOptions</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// such as: run(&#39;git&#39;, [&#39;commit&#39;, &#39;-m&#39;, commitMsg])</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">execa</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> stdio</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">inherit</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">opts</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// update &#39;package.json&#39; version</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">updateVersion</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">pkgPath</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">version</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">pkg</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fsExtra</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readJSONSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">pkgPath</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">pkg</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">version</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">version</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">writeFileSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">pkgPath</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">pkg</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></li><li><p>åç»­æˆ‘ä»¬å°±åªéœ€è¦é€šè¿‡ <code>yarn push</code> å‘½ä»¤ï¼Œå°±å¯ä»¥æ›¿æ¢å¦‚ä¸‹çš„ <code>git</code> å‘½ä»¤æ“ä½œï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">git add </span><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># git add -A</span></span>
<span class="line"><span style="color:#A6ACCD;">git commit -m </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">feat(scripts/*): add shell commands</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">git push</span></span>
<span class="line"></span></code></pre></div></li></ul>`,22),e=[p];function c(t,r,D,y,F,i){return a(),n("div",null,e)}const d=s(o,[["render",c]]);export{A as __pageData,d as default};
